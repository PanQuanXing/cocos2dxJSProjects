{"version":3,"sources":["Game.js"],"names":["cc","Class","extends","Component","properties","starPrefab","default","type","Prefab","maxStarDuration","minStarDuration","ground","Node","player","scoreLabel","Label","scoreAudio","url","AudioClip","onLoad","groundY","y","height","timer","spawnNewStar","score","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","getComponent","game","starDuration","random0To1","randY","jumpHeight","maxX","width","randX","randomMinus1To1","p","start","update","dt","gameOver","stopAllActions","director","loadScene","gainScore","string","toString","audioEngine","playEffect"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAW;AACPC,qBAAQ,IADD;AAEPC,kBAAMP,GAAGQ;AAFF,SADH;AAKRC,yBAAgB,CALR;AAMRC,yBAAgB,CANR;;AAQRC,gBAAO;AACHL,qBAAQ,IADL;AAEHC,kBAAMP,GAAGY;AAFN,SARC;;AAaRC,gBAAO;AACHP,qBAAQ,IADL;AAEHC,kBAAMP,GAAGY;AAFN,SAbC;AAiBRE,oBAAW;AACPR,qBAAS,IADF;AAEPC,kBAAMP,GAAGe;AAFF,SAjBH;AAqBR;AACAC,oBAAW;AACPV,qBAAQ,IADD;AAEPW,iBAAIjB,GAAGkB;AAFA;AAtBH,KAHP;;AA+BL;;AAEAC,YAAO,kBAAW;AACd,aAAKC,OAAL,GAAa,KAAKT,MAAL,CAAYU,CAAZ,GAAc,KAAKV,MAAL,CAAYW,MAAZ,GAAmB,CAA9C;AACA;;AAEA;AACA;;AAEA;AACA,aAAKC,KAAL,GAAW,CAAX;AACA;AACA,aAAKC,YAAL;AACA;AACA,aAAKC,KAAL,GAAW,CAAX;AACH,KA9CI;;AAgDLD,kBAAa,wBAAU;AACnB,YAAIE,UAAQ1B,GAAG2B,WAAH,CAAe,KAAKtB,UAApB,CAAZ;AACA,aAAKuB,IAAL,CAAUC,QAAV,CAAmBH,OAAnB;AACAA,gBAAQI,WAAR,CAAoB,KAAKC,kBAAL,EAApB;AACAL,gBAAQM,YAAR,CAAqB,MAArB,EAA6BC,IAA7B,GAAkC,IAAlC;;AAEA,aAAKC,YAAL,GAAkB,KAAKxB,eAAL,GAAqBV,GAAGmC,UAAH,MAAiB,KAAK1B,eAAL,GAAqB,KAAKC,eAA3C,CAAvC;AACA,aAAKa,KAAL,GAAW,CAAX;AACH,KAxDI;;AA0DLQ,wBAAmB,8BAAU;AACzB,YAAIK,QAAM,KAAKhB,OAAL,GAAapB,GAAGmC,UAAH,KAAgB,KAAKtB,MAAL,CAAYmB,YAAZ,CAAyB,QAAzB,EAAmCK,UAAhE,GAA2E,EAArF;AACA,YAAIC,OAAK,KAAKV,IAAL,CAAUW,KAAV,GAAgB,CAAzB;AACA,YAAIC,QAAMxC,GAAGyC,eAAH,KAAqBH,IAA/B;AACA,eAAOtC,GAAG0C,CAAH,CAAKF,KAAL,EAAWJ,KAAX,CAAP;AACH,KA/DI;;AAiELO,SAjEK,mBAiEI,CAER,CAnEI;AAqELC,UArEK,kBAqEGC,EArEH,EAqEO;AACR,YAAG,KAAKtB,KAAL,GAAW,KAAKW,YAAnB,EAAgC;AAC5B,iBAAKY,QAAL;AACA;AACH;AACD,aAAKvB,KAAL,IAAYsB,EAAZ;AACH,KA3EI;;AA4ELC,cAAS,oBAAU;AACf,aAAKjC,MAAL,CAAYkC,cAAZ;AACA;AACA/C,WAAGgD,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACH,KAhFI;AAiFL;AACAC,eAAU,qBAAU;AAChB,aAAKzB,KAAL,IAAY,CAAZ;AACA,aAAKX,UAAL,CAAgBqC,MAAhB,GAAuB,WAAS,KAAK1B,KAAL,CAAW2B,QAAX,EAAhC;AACA;AACApD,WAAGqD,WAAH,CAAeC,UAAf,CAA0B,KAAKtC,UAA/B,EAA0C,KAA1C;AACH;AAvFI,CAAT","file":"Game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        starPrefab:{\n            default:null,\n            type: cc.Prefab\n        },\n        maxStarDuration:0,\n        minStarDuration:0,\n\n        ground:{\n            default:null,\n            type: cc.Node\n        },\n\n        player:{\n            default:null,\n            type: cc.Node\n        },\n        scoreLabel:{\n            default: null,\n            type: cc.Label\n        },\n        //声明得分音效资源\n        scoreAudio:{\n            default:null,\n            url:cc.AudioClip\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad:function() {\n        this.groundY=this.ground.y+this.ground.height/2;\n        //this.spawnNewStar();\n\n        //初始化计分\n        //this.score=0;\n\n        //初始化计时变量,在调用生成星星方法spawnNewStar()前加入计时需要的变量声明\n        this.timer=0;\n        //生成一个新的星星\n        this.spawnNewStar();\n        //初始化计分\n        this.score=0;\n    },\n\n    spawnNewStar:function(){\n        var newStar=cc.instantiate(this.starPrefab);\n        this.node.addChild(newStar);\n        newStar.setPosition(this.getNewStarPosition());\n        newStar.getComponent('Star').game=this;\n\n        this.starDuration=this.minStarDuration+cc.random0To1()*(this.maxStarDuration-this.minStarDuration);\n        this.timer=0;\n    },\n\n    getNewStarPosition:function(){\n        var randY=this.groundY+cc.random0To1()*this.player.getComponent('Player').jumpHeight+50;\n        var maxX=this.node.width/2;\n        var randX=cc.randomMinus1To1()*maxX;\n        return cc.p(randX,randY);\n    },\n\n    start () {\n\n    },\n\n    update (dt) {\n        if(this.timer>this.starDuration){\n            this.gameOver();\n            return;\n        }\n        this.timer+=dt;\n    },\n    gameOver:function(){\n        this.player.stopAllActions();\n        //重新加载&开始\n        cc.director.loadScene('game');\n    },\n    //得分后调用的函数\n    gainScore:function(){\n        this.score+=1;\n        this.scoreLabel.string='SCORE:'+this.score.toString();\n        //播放得分音效\n        cc.audioEngine.playEffect(this.scoreAudio,false);\n    }\n});\n"]}